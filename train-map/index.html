<!DOCTYPE html>
<meta charset="utf-8">
<html>
<body>

<script src="http://d3js.org/d3.v3.min.js"></script>
<script>
  d3.selection.prototype.moveToFront = function() {
    return this.each(function(){      
      parent = this.parentNode;
      if(parent.parentNode.nodeName == "g") {
        parent.parentNode.parentNode.appendChild(parent);
      } else if(parent.nodeName == "g") {
        parent.parentNode.appendChild(parent);
      } else {
        this.parentNode.appendChild(this);  
      }
    });
  };

  d3.xml("banekort.svg", "image/svg+xml", function(xml) {
    document.body.appendChild(xml.documentElement);

    start = d3.select("#circle-a-hundige");
    end = d3.select("#circle-a-sydhavnen");
    svg = d3.select("svg");

    // Create circle at start location
    var mycircle = svg
      .append("g")
      .append("circle")
        .attr("r", 2.5)
        .attr("class", "train-a")
        .attr("cx", start.attr("cx"))
        .attr("cy", start.attr("cy"));

    // Animate circle coordinates (Move from start to end)
    d3.select(".train-a").transition()
      .duration(5000)
      .attr("cx", end.attr("cx"))
      .attr("cy", end.attr("cy"));

    // Lane muse-hover animation
    d3.selectAll(".lane-a-group").on("mouseover", function(d) {
      lane = d3.select(this);
      oldcolor = lane.style("stroke");

      // Fade overlay
      d3.select("#fade-overlay").style("display", "");

      d3.selectAll(".lane-a-group").moveToFront();

      lane.on("mouseout", function(d) {
        d3.select("#fade-overlay").style("display", "none");
      });
    });
  });
</script>
</body>
</html>